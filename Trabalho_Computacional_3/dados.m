clear,clc
% Parametros
% c = 0.0001
% alpha = 0.995
% eplison = 0.001
% -------------------------------------------------------------------------------------------------------------
% Metodo de Barreira
% -------------------------------------------------------------------------------------------------------------
% Primeiro problema
f11 = @(x)100*(x(2)-x(1)^2)^2+(1-x(1))^2; % funcao f11
gf11 = @(x)[2*(200*x(1)^3-200*x(1)*x(2)+x(1)-1), 200*(x(2)-x(1)^2)]; % gradiente de f11
f11g1 = @(x)x(1)-x(2)^2; % restricao g1
f11dg1 = @(x)[1, -2*x(2)]; % vetor gradiente de g1
f11g2 = @(x)x(1)^2-x(2); % restricao g2
f11dg2 = @(x)[2*x(1), -1]; % vetor gradiente de g2
f11x0 = [-2 1]; % ponto inicial
%H11 = @(x)[2*(600*x(1)^2-200*x(2)+1),-400*x(1); -400*x(1), 200]; % hessiana de f11
H11 = [4402, 800; 800, 200]; % hessiana de f11 no ponto inicial
% -------------------------------------------------------------------------------------------------------------
% Segundo problema
f12 = @(x)x(1)^2+0.5*x(2)^2+x(3)^2+0.5*x(4)^2-x(1)*x(3)+x(3)*x(4)-x(1)-3*x(2)+x(3)-x(4); % funcao objetivo f12
gf12 = @(x)[2*x(1)-x(3)-1, x(2)-3, 2*x(3)-x(1)+x(4)+1, x(4)+x(3)-1]; % gradiente de f12
f12g1 = @(x)5-x(1)-2*x(2)-x(3)-x(4); % restricao g1
f12dg1 = @(x)[1, 2, 1, 1]; % vetor gradiente de g1
f12g2 = @(x)4-3*x(1)-x(2)-2*x(3)+x(4); % restricao g2
f12dg2 = @(x)[3, 1, 2, -1]; % vetor gradiente de g2
f12g3 = @(x)x(2)+4*x(3)-1.5; % restricao g3
f12dg3 = @(x)[0, -1, 0,-4]; % vetor gradiente de g3
f12x0 = [0.5 0.5 0.5 0.5]; % ponto inicial
H12 = [2, 0, -1, 0; 0, 1, 0, 0; -1, 0, 2, 1; 0, 0, 1, 1]; % hessiana de f12
% ------------------------------------------------------------------------------------------------------------
% Terceiro problema
f13 = @(x)(x(1)-10)^3+(x(2)-20)^3; % funcao f13
gf13 = @(x)[3*(x(1)-10)^2, 3*(x(2)-20)^2]; % gradiente de f13
f13g1 = @(x)(x(1)-5)^2+(x(2)-5)^2-100; % restricao g1
f13dg1 = @(x)[10-2*x(1), 20-2*x(2)]; % vetor gradiente de g1
f13g2 = @(x)(x(1)-6)^2+(x(2)-5)^2; % restricao g2
f13dg2 = @(x)[12-2*x(1), 10-2*x(2)]; % vetor gradiente de g2
f13g3 = @(x)82.81-(x(1)-6)^2-(x(2)-5)^2; % restricao g3
f13dg3 = @(x)[2*x(1)-12, 2*x(2)-10]; % vetor gradiente de g3
f13x0 = [14.115 0.885]; % ponto inicial
%H13 = @(x)[6*(x(1)-10), 0; 0, 6*(x(2)-20)]; % hessiana de f13
H13 = [24.6900, 0; 0, -114.6900]; % hessiana de f13 no ponto incial
% ------------------------------------------------------------------------------------------------------------
% Metodo de Penalidade e Lagrangeana Aumentada
% ------------------------------------------------------------------------------------------------------------
% Primeiro problema
f21 = @(x)0.01*(x(1)-1)^2+(x(2)-x(1)^2)^2; % funcao f21
gf21 = @(x)[-4*x(1)*(-x(1)^2+x(2))+0.02*x(1)-0.02, -2*x(1)^2+2*x(2)]; % gradiente de f21
f21h1 = @(x)x(1)+x(3)^2+1; % restricao h1
f21dh1 = @(x)[1, 2*x(3)]; % vetor gradiente de h1
f21x0 = [2, 2, 2]; % ponto inicial
%H21 = @(x)[12*x(1)^2-4*x(2)+0.02, -4*x(1); -4*x(1), 2]; % hessiana de 21
H21 = [40.0200, -8.0000; -8.0000, 2.0000]; % hessiana de f21 no ponto inicial
% ------------------------------------------------------------------------------------------------------------
% Segundo problema
f22 = @(x)(x(1)-x(2))^2+(x(2)+x(3)-2)^2+(x(4)-1)^2+(x(5)-1)^2; % funcao f22
gf22 = @(x)[2*x(1)-2*x(2); -2*x(1)+4*x(2)+2*x(3)-4; 2*x(2)+2*x(3)-4; 2*x(4)-2;2*x(5)-2]; % vetor gradiente de f22
f22h1 = @(x)x(1)+3*x(2)-4; % restricao h1
f22dh1 = @(x)[1, 3, 0, 0, 0]; % vetor gradiente de h1
f22h2 = @(x)x(3)+x(4)-2*x(5); % restricao h2
f22dh2 = @(x)[0, 0, 1, 1, -2]; % vetor gradiente de h2
f22h3 = @(x)x(2)-x(5); % restricao h3
f22dh3 = @(x)[0, 1, 0, 0, -1]; % vetor gradiente de h3
f22x0 = [2.5, 0.5, 2, -1, 0.5]; % ponto inicial
H22 = [2, -2, 0, 0, 0; -2, 4, 2, 0, 0; 0, 2, 2, 0, 0; 0, 0, 0, 2, 0; 0, 0, 0, 0, 2]; % hessiana de f22
% -------------------------------------------------------------------------------------------------------------
% Terceiro problema
f23 = @(x)(x(1)-2)^2+(x(2)-1)^2; % funcao f23
gf23 = @(x)[2*x(1)-4, 2*x(2)-2]; % gradiente de f23
f23g1 = @(x)0.25*x(1)^2+x(2)^2-1; % restricao g1
f23dg1 = @(x)[0.5*x(1), 2*x(2)]; % vetor gradiente de g1
f23h1 = @(x)x(1)-2*x(2)+1; % restricao h1
f23dh1 = @(x)[1, -2]; % vetor gradiente de h1
f23x0 = [2, 2]; % ponto inicial
H23 = [2, 0; 0, 2]; % hessiana de f23
% -------------------------------------------------------------------------------------------------------------
% Todos os tres metodos
% -------------------------------------------------------------------------------------------------------------
% Primeiro problema
f31 = @(x)x(1)*x(4)*(x(1)+x(2)+x(3))+x(3); % funcao f31
gf31 = @(x)[x(1)*x(4)+x(4)*(x(1)+x(2)+x(3)), x(1)*x(4), x(1)*x(4)+1, x(1)*(x(1)+x(2)+x(3))]; % gradiente de f31
f31g1 = @(x)x(1)*x(2)*x(3)*x(4); % restricao g1
f31dg1 = @(x)[-x(2)*x(3)*x(4), -x(1)*x(3)*x(4), -x(1)*x(2)*x(4), -x(1)*x(2)*x(3)]; % vetor gradiente de g1
f31g2 = @(x)x(1)^2+x(2)^2+x(3)^2+x(4)^2-40; % restricao g2
f31dg2 = @(x)[-2*x(1), -2*x(2), -2*x(3), -2*x(4)]; % vetor gradiente de g2
f31x0 = [3, 4, 4, 3]; % ponto inicial
%H31 = @(x)[2*x(4), x(4), x(4), 2*x(1)+x(2)+x(3); x(4), 0, 0, x(1); x(4), 0, 0, x(1); 2*x(1)+x(2)+x(3), x(1), x(1), 0]; % hessiana de f31
H31 = [6, 3, 3, 14; 3, 0, 0, 3; 3, 0, 0, 3; 14, 3, 3, 0]; % hessiana de f31 no ponto inicial
% -------------------------------------------------------------------------------------------------------------
% Segundo problema
f32 = @(x)x(1)-x(2)-x(3)-x(1)*x(3)+x(1)*x(4)+x(2)*x(3)-x(2)*x(4); % funcao f32
gf32 = @(x)[-x(3)+x(4)+1, x(3)-x(4)-1, -x(1)+x(2)-1, x(1)-x(2)]; % gradiente de f32
f32g1 = @(x)8-x(1)-2*x(2); % restricao g1
f32dg1 = @(x)[1, 2, 0, 0]; % vetor gradiente de g1
f32g2 = @(x)12-4*x(1)-x(2); % restricao g2
f32dg2 = @(x)[4, 1, 0, 0]; % vetor gradiente de g2
f32g3 = @(x)12-3*x(3)-4*x(2); % restricao g3
f32dg3 = @(x)[3, 4, 0, 0]; % vetor gradiente de g3
f32g4 = @(x)8-2*x(3)-x(4); % restricao g4
f32dg4 = @(x)[0, 0, 2, 1]; % vetor gradiente de g4
f32g5 = @(x)8-x(3)-2*x(4); % restricao g5
f32dg5 = @(x)[0, 0, 1, 2]; % vetor gradiente de g5
f32g6 = @(x)5-x(3)-x(4); % restricao g6
f32dg6 = @(x)[0, 0, 1, 1]; % vetor gradiente de g6
f32x0 = [1, 1, 1, 1]; % ponto inicial
H32 = [0, 0, -1, 1; 0, 0, 1, -1; -1, 1, 0, 0; 1, -1, 0, 0]; % hessiana de f32
% -------------------------------------------------------------------------------------------------------------
% Terceiro problema
f33 = @(x)(x(1)-10)^2+5*(x(2)-12)^2+x(3)^4+3*(x(4)-11)^2+10*x(5)^6+7*x(6)^2+x(7)^4-4*x(6)*x(7)-10*x(6)-8*x(7); % funcao f33
gf33 = @(x)[2*x(1)-20, 10*x(2)-120, 4*x(3)^3, 6*x(4)-66, 60*x(5)^5, 14*x(6)-4*x(7)-10, -4*x(6)+4*x(7)-8]; % gradiente de f33
f33g1 = @(x)127-x(1)^2-3*x(2)^4-x(3)-4*x(4)^2-5*x(5); % restricao g1
f33dg1 = @(x)[2*x(1), 12*x(2), 1, 8*x(4), 5, 0, 0]; % vetor gradiente de g1
f33g2 = @(x)282-7*x(1)-3*x(2)-10*x(3)^2-x(4)+x(5); % restricao g2
f33dg2 = @(x)[7, 3, 20*x(3), 1, -1, 0, 0]; % vetor gradiente de g2
f33g3 = @(x)196-23*x(1)^2-x(2)^2-6*x(6)^2+8*x(7); % restricao g3
f33dg3 = @(x)[46*x(1), 2*x(2), 0, 0, 0, 12*x(6), -8]; % vetor gradiente de g3
f33g4 = @(x)-4*x(1)^2-x(2)^2+3*x(1)*x(2)-2*x(3)^2-5*x(6)+11*x(7); % restricao g4
f33dg4 = @(x)[8*x(1)-3*x(2), -3*x(1)+2*x(2), 4*x(3), 0, 0, 5, -11]; % vetor gradiente de g4
f33x0 = [1, 2, 0, 4, 0, 1, 1]; % ponto inicial
%H33 = @(x)[2, 0, 0, 0, 0, 0, 0; 0, 10, 0, 0, 0, 0, 0; 0, 0, 12*x(3)^2, 0, 0, 0, 0; 0, 0, 0, 6, 0, 0, 0; 0, 0, 0, 0, 300*x(5)^4, 0, 0; 0, 0, 0, 0, 0, 14, -4; 0, 0, 0, 0, 0, -4, 12*x(7)^2]; % hessiana de f33
H33 = [2, 0, 0, 0, 0, 0, 0; 0, 10, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0, 0; 0, 0, 6, 0, 0, 0, 0; 0, 0, 0, 0, 0, 0, 0; 0, 0, 0, 0, 0, 14, -4; 0, 0, 0, 0, 0, -4, 12]; % hessiana de f33 no ponto inicial
